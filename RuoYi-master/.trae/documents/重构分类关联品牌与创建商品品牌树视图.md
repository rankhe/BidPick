## 目标
- 分类与品牌建立明确关联：分类属于品牌；品牌下可有多级分类。
- 创建商品页面提供左侧品牌树（品牌 → 分类 → 商品），右侧根据选中节点展示对应列表（品牌列表 / 分类列表 / 商品列表）。

## 数据模型调整
- ProdCategory（产品分类）：新增字段 `brandId`（bigint，不为空），用于指向品牌；保留现有 `level`、`parentId` 以支持品牌内分类层级。
- ProdBrand：保持现状。
- ProdInfo：保持现状（通过 `categoryId` 关联分类即可从分类获得品牌归属）。如后续需要严格的双向约束，可增量加入 `brandId`（暂不修改以最小改动满足需求）。

## 数据库迁移（SQL草案）
- `ALTER TABLE prod_category ADD COLUMN brand_id bigint NOT NULL DEFAULT 0;`
- 对历史数据回填策略（可选）：将顶级分类的 `brand_id` 设置为其所属品牌；子级分类继承父级分类的 `brand_id`。

## 后端接口设计
- 品牌树数据（左侧树）：
  - GET `/product/tree/brand` → 返回品牌节点列表（`[{id,name,type:'brand'}]`）
  - GET `/product/tree/category/{brandId}` → 返回该品牌下的分类树（支持层级：使用 `parentId` & `level`）
  - GET `/product/tree/product/{categoryId}` → 返回该分类下的产品列表（`ProdInfo`，分页可选）
- 创建商品页面数据联动：
  - 品牌列表：`POST /product/brand/list`（已有）
  - 分类列表按品牌：`POST /product/category/list` 支持 `brandId` 过滤（在查询条件中新增 `brandId`）
  - 产品列表按分类：`POST /product/info/list` 支持 `categoryId` 过滤（已有）
- 分类管理维度：
  - 在 `ProdCategoryController` 的 `add/edit` 表单中新增品牌选择（从当前用户的品牌集合中选择）；查询支持 `brandId` 条件。

## Service/Mapper 修改
- ProdCategory
  - Domain：新增 `brandId` 字段与 getter/setter
  - Mapper XML：
    - 查询：`where` 增加 `brand_id=#{brandId}` 条件
    - 插入/更新：增加 `brand_id` 对应的列
  - Service：无需复杂修改，透传新增条件
- 新增树接口的 Controller & Service（可放在 `ProdInfoController` 或独立 `TreeController`）：
  - `GET /product/tree/brand` 使用品牌 Service 列出品牌
  - `GET /product/tree/category/{brandId}` 使用分类 Service 按 `brandId` 拉取并构建树
  - `GET /product/tree/product/{categoryId}` 使用产品 Service 按 `categoryId` 拉取产品

## 前端改造
- 创建商品页面新增“品牌树式选择”视图（不替换原有表单，新增一个向导页更友好）：
  - 新页面：`templates/product/info/create-wizard.html`
  - 左侧树：三级树（品牌→分类→商品），点击节点加载右侧内容
  - 右侧内容：
    - 选中根节点：显示品牌列表（可选择进入品牌）
    - 选中某个品牌：显示该品牌下的分类列表（点击分类加载产品）
    - 选中某个分类：显示该分类下的产品表格（可勾选产品进行创建或带入表单）
  - 组件：复用 `bootstrap-table` + 简易树（可用 zTree/Bootstrap TreeView，统一返回 `{id,name,type,children}` 模式）
- 分类管理页面：
  - `category/add.html` 与 `category/edit.html` 增加品牌下拉框；列表页增加 `brandId` 搜索项与显示列

## 交互流（创建商品）
1. 进入“创建商品向导”页，左侧树初始展示品牌（根）；右侧展示品牌列表
2. 选择某品牌，左侧展开其分类树；右侧展示该品牌分类列表
3. 选择某分类，左侧标记分类节点；右侧展示该分类下的产品；支持点击某产品进入现有“新增产品信息”表单并自动填充 `categoryId`/`brandName`

## 验收标准
- 分类与品牌的关联可在管理页增删改查并能按品牌过滤分类
- 创建商品向导页的左侧树联动正常：品牌→分类→商品；右侧列表与选择同步
- 按分类创建商品流程顺畅，自动带入分类与品牌信息

## 影响与兼容
- 现有产品与分类逻辑不变，只在分类层面增加品牌关联；产品依然通过分类确定归属
- 新页面不破坏现有“新增产品信息”页面；两者可并存

如确认，我将：先在分类模型与 Mapper 增加 `brandId`，扩展查询与表单；随后实现树接口与新向导页面，并联调右侧列表联动。