## 问题现状与差距
- 批次发布页已支持一次性选择商品并填写数量，提交到 `POST /product/batch/publish`，创建 `batch_info` 并插入 `batch_product`（ruoyi-admin/src/main/resources/templates/product/batch/add.html:64-81；ruoyi-admin/src/main/java/com/ruoyi/web/controller/product/BatchInfoController.java:141-172）。
- 追加条目接口已存在：`POST /product/batch/{id}/items`（BatchInfoController.java:174-200）。
- 但批次列表页缺少“商品维护”入口与页面，无法：查看批次内商品条目、增删改条目数量、移除条目（ruoyi-admin/src/main/resources/templates/product/batch/batch.html:109-116）。
- 数据层已具备：`batch_product` 的增删改查与按批次筛选（ruoyi-system/src/main/resources/mapper/product/BatchProductMapper.xml:25-33,58-74,79-81；服务接口/实现同名方法）。

## 目标与范围
- 为每个批次提供完整的“商品维护”功能：查看、添加（多选+数量）、修改数量、删除条目。
- 接口与页面遵循 RuoYi 的现有风格与权限控制，复用现有服务与 Mapper。
- 不改动既有 `publish/append` 行为；在此基础上补齐维护能力。

## 后端设计
- 新增控制器 `BatchProductController`（路径：`ruoyi-admin/src/main/java/com/ruoyi/web/controller/product/BatchProductController.java`）：
  - `GET /product/batch/items/{batchId}`：返回维护页。
  - `POST /product/batch/items/list`：入参 `batchId`，分页返回条目列表；为方便展示，联表或在 Controller 层补充商品信息（名称、品牌、分类）。
  - `POST /product/batch/items/add`：入参 `batchId` + `items=[{prodTemplateId,count}]`，复用 `appendItems` 逻辑插入多条。
  - `POST /product/batch/items/update`：入参 `id`、`publishCount`，更新条目数量；校验 `publishCount >= lockedCount`。
  - `POST /product/batch/items/remove`：入参 `ids`，批量删除；校验条目 `lockedCount==0` 才可删除。
- 复用服务与 Mapper：`IBatchProductService.selectBatchProductList/insert/update/delete/selectByBatchAndProd`（ruoyi-system/.../service/IBatchProductService.java:8-15；impl:16-22）。
- 条目列表数据增强：两种实现任选其一（为保持简单，建议在 Controller 层拼装）：
  - 方案A（Controller拼装）：查 `BatchProduct` 后，循环用 `IProdInfoService.selectProdInfoById` 补充 `name/brandName/categoryName`（ruoyi-system/.../service/IProdInfoService.java；ProdInfo字段见 ruoyi-system/.../domain/ProdInfo.java）。
  - 方案B（Mapper联表）：新增 `selectBatchProductDetailList` 联表 `prod_info`；返回自定义 VO。
- 权限控制：新增 `product:batch:items:view/list/add/edit/remove`，在 Controller 注解与模板按钮中使用。

## 前端管理页
- 批次列表页增加“维护商品”操作按钮：在 `batch.html` 的操作列追加 `维护商品`，跳转 `GET /product/batch/items/{id}`（ruoyi-admin/src/main/resources/templates/product/batch/batch.html:109-116）。
- 新页面 `items.html`（路径：`ruoyi-admin/src/main/resources/templates/product/batch/items.html`）：
  - 顶部展示当前批次基本信息（批次编码、截止时间、说明）。
  - `#items-table` 列表列：`商品ID`、`名称`、`品牌`、`分类`、`发布数量`、`已锁定数量`、`操作`。
  - 工具栏：
    - “添加商品”按钮：弹出商品列表（复用 `product/info/list` 数据源；支持多选与数量输入），提交到 `POST /product/batch/items/add`。
    - “删除”按钮：批量删除选中条目，`POST /product/batch/items/remove`。
  - 行内操作：
    - “修改数量”：弹窗输入或行内编辑后 `POST /product/batch/items/update`；校验不小于锁定数。
- 交互与样式：沿用 RuoYi 的 `bootstrapTable`、`$.operate`、`$.table` 等封装与校验，保持一致体验（参考 add.html:84-107）。

## 校验与约束
- 数量约束：`publishCount >= lockedCount`，否则拒绝更新/删除。
- 重复商品处理：若同一批次存在同一商品条目，`add` 时可选择合并（更新数量）或拒绝重复；建议合并。
- 状态过滤：仅展示 `status=OK` 条目；删除操作置为物理删除或改为逻辑删除，按现有 Mapper 风格保留物理删除。

## 验证方案
- 创建新批次，发布时选择多商品与数量，成功后在维护页能看到条目列表。
- 在维护页：
  - 添加新商品到批次，列表即时刷新并显示正确数量。
  - 修改数量，低于锁定数时报错；合法更新成功。
  - 删除条目，若锁定数大于0则禁止；否则成功删除。
- 回归：原有发布页功能不受影响；批次列表页动作正常。

## 影响面与兼容性
- 数据库不变（复用 `batch_product`）；新增只读联表查询（如选方案B）。
- 权限需在菜单与角色中补全；默认仅批次所属人可维护（可在 Controller 中校验 `ownerId==currentUserId`）。
- Weapp/H5 无需变更；未来如需查询批次条目，可复用 `items/list`。

## 交付清单
- 新增控制器 `BatchProductController` 及 5 个接口。
- 新增模板 `templates/product/batch/items.html`。
- 更新 `batch.html` 操作列增加“维护商品”。
-（可选）新增 Mapper 联表查询及 VO 类。

确认后，我将按上述方案落地实现，并自测通过后提交修改。